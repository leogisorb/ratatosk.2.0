<!-- 
Quellen: 
Facemesh-input: https://github.com/google/mediapipe/blob/master/docs/solutions/face_mesh.md 
Service-Glocke: https://soundbible.com/1599-Store-Door-Chime.html von Mike Koenig, Attribution 3.0
tastatur-layout: https://www.youtube.com/watch?v=3yq6vCjswaE
Farbfilter: https://codepen.io/sosuke/pen/Pjoqqp
Kontratanalyse: https://color.adobe.com/de/create/color-contrast-analyzer
Icons: https://www.flaticon.com/icon-fonts-most-downloaded

f√ºr dieses Dokument wichtige Landmarks von MediaPipe: 
Gesichtsgr√∂√üe oben/unten(10/152); Rechtes Auge(160,159/ 144,145); linkes Auge(387,386/ 374,373)

interessante Anmerkungen:
    - Selbst wenn nur die Stirn und die Augen auf dem Bild zu erkennen sind funktioniert das Programm (-> gute KI?)

To-Do:
    - OK: Variable f√ºr Augen-zu-Zeit-Messung
    - OK: Augen-Aktion etwas ausf√ºhren lassen
    - OK: Aufleuchtende Symbole einf√ºgen
    - OK: je nach aufgeleichtetem Symbol w√§hrend augen-aktion ausf√ºhren lassen
    - OK: Design von Voca-app "borgen"
    - OK: √úberall Wo-bin-ich-gerade einf√ºgen
    - OK: schmerz-skala einf√ºgen

    - Das ganze auf einen Server klatschen
    - OK: Abh√§ngigkeit von Displaygr√∂√üe / Autoscrolling
    - 25 / x : Bericht schreiben
    - Feiern

Known Bugs:
    - buttons in divs f√ºhren beim anklicken die klick-Funktionen von beidem
    - Mesagebox kann bis zur unkenntlichkeit beschrieben werden (nicht lesbar)

Bearbeitet von Barbara Kammerl
-->


<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
   <link rel="shortcut icon" type="image/svg" href="Ratatosk_smol.svg"/>
   <link rel="stylesheet" type="text/css" href="pageStyle.css"/>
   <meta content="width=device-width, height=device-height, initial-scale=1.0">

  <title>Ratatosk-Testseite</title>
  <!-- Import f√ºr facemesh im Web -->
  <!--   <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js" crossorigin="anonymous"></script> -->

  <!-- Import f√ºr facemesh ohne Web -->
  <script src="./camera_utils.js" crossorigin="anonymous"></script>
  <script src="./control_utils.js" crossorigin="anonymous"></script>
  <script src="./drawing_utils.js" crossorigin="anonymous"></script>
  <script src="./face_mesh.js" crossorigin="anonymous"></script>
  <script src="./audio.js"></script>
  <script src="./speech.js"></script>
  <script src="./tts-fallback.js"></script>
</head>

<body>
  <script type="module">  
    const videoElement = document.getElementById("input_video"); 
    
    // Einfache Kamera-Initialisierung f√ºr iPhone-Kompatibilit√§t
    async function initCamera() {
      try {
        console.log('Initialisiere Kamera...');
        
        if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
          console.error('getUserMedia nicht verf√ºgbar');
          return false;
        }
        
        // Einfachere Constraints f√ºr bessere Kompatibilit√§t
        const stream = await navigator.mediaDevices.getUserMedia({
          video: {
            facingMode: 'user',
            width: { ideal: 640 },
            height: { ideal: 480 }
          },
          audio: false
        });
        
        if (videoElement) {
          videoElement.srcObject = stream;
          
          // Warten bis Video geladen ist
          await new Promise((resolve, reject) => {
            videoElement.onloadedmetadata = () => {
              console.log('Video-Metadaten geladen');
              resolve();
            };
            videoElement.onerror = (error) => {
              console.error('Video-Loading Fehler:', error);
              reject(error);
            };
            // Timeout nach 5 Sekunden
            setTimeout(() => {
              reject(new Error('Video-Loading Timeout'));
            }, 5000);
          });
          
          console.log('Kamera erfolgreich initialisiert');
          return true;
        }
        
      } catch (error) {
        console.error('Kamera-Initialisierung fehlgeschlagen:', error);
        
        // Benutzerfreundliche Fehlermeldung
        let errorMessage = "Kamera konnte nicht initialisiert werden.\n\n";
        
        if (error.name === 'NotAllowedError') {
          errorMessage += "üîí Kamera-Zugriff verweigert\n\n";
          errorMessage += "Auf iPhone:\n";
          errorMessage += "1. Einstellungen ‚Üí Safari ‚Üí Kamera ‚Üí Erlauben\n";
          errorMessage += "2. Oder in Safari: Adressleiste ‚Üí Kamera-Symbol ‚Üí Erlauben\n";
          errorMessage += "3. Seite neu laden und erneut versuchen";
        } else if (error.name === 'NotFoundError') {
          errorMessage += "üì± Keine Kamera gefunden\n\n";
          errorMessage += "Bitte √ºberpr√ºfen Sie, ob eine Kamera verf√ºgbar ist.";
        } else if (error.name === 'NotReadableError') {
          errorMessage += "üìπ Kamera wird bereits verwendet\n\n";
          errorMessage += "Schlie√üen Sie andere Apps, die die Kamera verwenden.";
        } else {
          errorMessage += "üîß Technischer Fehler: " + error.message;
        }
        
        alert(errorMessage);
        return false;
      }
    }
    
    // Kamera beim Laden initialisieren
    window.addEventListener('load', () => {
      console.log('Seite geladen, initialisiere Kamera...');
      initCamera();
    });
    
    // facefactor bestimmt ab welchem Gro√üenfaktor ein geschlossenes Auge erkannt wird.
    // Die H√∂he des Gesichtes wird hiermit multipliziert um einen Grenzwert festzulegen.
    // Aus Selbstets ergab sich ein Faktor von 35 bis 60 als ideal f√ºr niedrigen und hohen Abstand zwischen Gesicht und Kamera.
    var facefactor = 55; 
    //time_closed gibt an, wie viele Sekunden die Augen geschlossen sein m√ºssen, um es als Aktion z√§hlen zu lassen.
    var time_closed = 2;

    //pre-load Images
    var images=[];
    function vorladen(...BilderSrc){
      for(var i=0; i<BilderSrc.length; i++){
        images[i]=new Image();
        images[i].src= BilderSrc[i];
      }
    }

    const serviceBell = new Audio('./ServiceGlocke.wav');
    
    // Audio-Initialisierung mit Fehlerbehandlung
    serviceBell.addEventListener('error', (e) => {
      console.error('Fehler beim Laden der Audio-Datei:', e);
    });
    
    serviceBell.addEventListener('loadstart', () => {
      console.log('Audio-Datei wird geladen...');
    });
    
    serviceBell.addEventListener('canplaythrough', () => {
      console.log('Audio-Datei erfolgreich geladen');
    });
    import { createApp } from 'vue/dist/vue.esm-bundler.js';
    
    // TTS-Hilfsfunktion f√ºr bessere Kompatibilit√§t (iPhone-optimiert)
    let isSpeaking = false; // Globale Flag um doppelte Wiedergabe zu verhindern
    let audioContext = null; // Audio Context f√ºr iPhone-Kompatibilit√§t
    let userInteracted = false; // Benutzerinteraktion f√ºr Audio-Aktivierung
    
    // Audio Context f√ºr iPhone initialisieren
    function initAudioContext() {
      if (!audioContext) {
        try {
          audioContext = new (window.AudioContext || window.webkitAudioContext)();
          console.log('Audio Context initialisiert');
        } catch (error) {
          console.error('Audio Context Fehler:', error);
        }
      }
    }
    
    // Benutzerinteraktion f√ºr Audio-Aktivierung
    function enableAudio() {
      userInteracted = true;
      initAudioContext();
      
      // Audio Context resume f√ºr iPhone
      if (audioContext && audioContext.state === 'suspended') {
        audioContext.resume().then(() => {
          console.log('Audio Context resumed');
        });
      }
    }
    
    function speakText(text) {
      if (!text || isSpeaking) {
        console.log('TTS-Helper: √úberspringe - Text:', text, 'Sprechend:', isSpeaking);
        return;
      }
      
      console.log('TTS-Helper: Versuche zu sprechen:', text);
      isSpeaking = true;
      
      // iPhone: Audio Context aktivieren
      if (!userInteracted) {
        enableAudio();
      }
      
      // Verwende nur EINE TTS-Implementierung (AdvancedTTS hat Priorit√§t)
      if (window.advancedTTS && window.advancedTTS.isInitialized) {
        console.log('TTS-Helper: Verwende AdvancedTTS');
        window.advancedTTS.speak(text);
        
        // Reset flag nach einer kurzen Verz√∂gerung
        setTimeout(() => {
          isSpeaking = false;
        }, 100);
        return;
      }
      
      // Fallback zur urspr√ºnglichen Implementierung
      if (window.speechManager && window.speechManager.isInitialized) {
        console.log('TTS-Helper: Verwende SpeechManager');
        window.speechManager.speak(text);
        
        // Reset flag nach einer kurzen Verz√∂gerung
        setTimeout(() => {
          isSpeaking = false;
        }, 100);
        return;
      }
      
      // Fallback: Native SpeechSynthesis f√ºr iPhone
      if ('speechSynthesis' in window) {
        console.log('TTS-Helper: Verwende native SpeechSynthesis');
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'de-DE';
        utterance.rate = 0.9;
        utterance.pitch = 1.0;
        utterance.volume = 1.0;
        
        utterance.onend = () => {
          console.log('TTS beendet');
          isSpeaking = false;
        };
        
        utterance.onerror = (error) => {
          console.error('TTS Fehler:', error);
          isSpeaking = false;
        };
        
        speechSynthesis.speak(utterance);
        return;
      }
      
      console.warn('TTS-Helper: Keine TTS-Implementierung verf√ºgbar');
      isSpeaking = false;
    }
    
    const element_click = createApp({
      el:"#element_click",
              data: () => {return { 
        auswahl: "Nichts Ausgew√§hlt", //Auswahl des schmerzenden K√∂rperteiles (Men√º 2)
        nachricht: "",                //Auswahl der gedr√ºckten Buchstaben (Men√º 3)
        selectedElement: "Start",    //Auswahl des momentan aufleuchtenden Symboles (√ºberall)
        element: "Start",
        selectedKeyboard : 0,
        isPaused: false,             // Pause-Status
        pauseRequested: false,       // Pause wurde angefordert
        currentPauseElement: null,   // Element bei dem pausiert wurde

        Keyboards: [
          //Alphabetisch:
        [["a","√§","b","c","ch","d","1","2"],
          ["e","f","g","h","i","j","3","4"],
          ["k","l","m","n","o","√∂","p","q"],
          ["r","s","sch","√ü","t","u","√º","v"],
          ["w","x","y","z",".",",","!","?"]],
          //Qwertz:
        [["1","2","3","4","5","6","7","8","9","0","√ü"],
         ["q","w","e","r","t","z","u","i","o","p","√º"],
         ["a","s","d","f","g","h","j","k","l","√∂","√§"],
         ["y","x","c","v","b","n","m",",",".","-","+"],
         // Keine Smileys in den ersten beiden Feldern
        ],
          //H√§ufigkeit:
        [["E","S","L","B","P","√ñ"],
          ["N","A","G","F","V","√ü"],
          ["I","D","M","K","√ú","Y"],
          ["R","H","C","W","√Ñ","X"],
          ["T","U","O","Z","J","Q"]],
        ],

        Schmerz:[
          //Kopf
        [["Stirn","Hinterkopf","Schl√§fe"],
          ["Ohr","Auge","Nebenh√∂len"],
          ["Nase", "Mund", "Kiefer"],
          ["Nacken", "Hals", "Speiser√∂hre"]],
        //Torso
        [["Herz","Brust","Schultern"],
          ["Lunge","Magen","Blase","H√ºfte"],
          ["Schulterbl√§tter","Wirbels√§ule"]],
        //Arme
        [["Finger","Handfl√§che","Handr√ºcken"],
          ["Unterarm","Ellenbogen","Ellenbeuge"],
          ["Oberarm","Schulter", "Achsel"]],
        //Beine
        [["Zehen","Fu√üballen","Fu√ür√ºcken"],
          ["Kn√∂chel","Unterschenkel","Knie"],
          ["Oberschenkel","H√ºfte","Geschl.organ"]],
        ],

        ZahlenMenu:[
          ["1","2","3"],
          ["4","5","6"],
          ["7","8","9"],
          ["+","0","-"]],

        UmgebungMenu:[
          //Gespraeche:
        [["Hallo! ","Guten Abend! ","Gute Nacht! "],
          ["Wie geht es dir? ","Wie f√ºhlst du dich? ","Wie geht es der Familie? "],
          ["Wo? ","Warum? ","Weshalb? "],
          ["Was ist passiert? ","Wann kommst du wieder? "],
          ["Auf Wieder sehen! ","Sch√∂n, dass du da warst! ","Besuche mich bald! "]],
          //Gegenst√§nde:
        [["Handy ","Glas ","Brille "],
          ["Stift ","Papier ","Lineal "],
          ["Teller ","Besteck ","Tisch "]],
          //Im Zimmer:
        [["T√ºr ","Fenster ","Licht "],
          ["Bett ","Tisch ","Stuhl "],
          ["Fernseher ","Vorhang ","Schrank "]],
          //Im Bett:
        [["Decke ","Kissen ","Bezug "],
          ["Veschieben ","Wechseln ","Fernbedienung "]],
        ],

        IchMenu:[
          //Ern√§hrung:
        [["Essen ","Trinken "],
         ["s√º√ü ","herzhaft ","scharf "],
         ["kalt ","warm ","lauwarm "],
         ["trocken ","nass ","breiig "],
         ["Wasser ","Saft ","Milch "]],
          //Gef√ºhle:
        [["gl√ºcklich ","froh ","erleichtert "],
          ["traurig ","w√ºtend ","einsam ","√§ngstlich "],
          ["gelangweilt ","gestresst ","unsicher "],
          ['\u{1F44D}','\u{1F44E}','\u{1F44F}','\u{1F44B}','\u{1F634}'],
          ['\u{1F495}','\u{1F4A7}','\u{1F60E}','\u{1F614}','\u{1F618}']],
          //Kleidung:
        [["M√ºtze ","Ohrst√∂psel ","Schaal "],
          ["Hemd ","T-Shirt ","Pullover "],
          ["Hose ","G√ºrtel ","Socken "]],
          //Hygiene:
        [["auf die Toilette ","Z√§hne putzen ","duschen ","baden "],
          ["H√§nde waschen ","Haare k√§mmen ","umziehen "]],
          //Bewegung:
        [["drehen ","legen ","st√ºtzen ","schieben "],
          ["Arm ","Bein ","Kopf ","K√∂rper ","Bett "],
          ["rechts ","links ","oben ","unten ","vorne ","hinten "],
          ["anwinkeln ","zur Seite "]],
        ],

        Schmerzskala:
        ["10","9","8","7","6","5","4","3","2","1","0"],

        Blinkzeiten:
        ["1","1.5","2","4","5","8"],

        waittime: 2000,       // Zeit die Symbole aufblinken
        closed_frames: 0,     // Anzahl der "frames"(Ger√§teabh√§ngig) die Augen zu sind

        cngTime_closed: false,  //Orientierung ob closed_frames ge√§ndert werden darf
        showMenu: -1,         // Orientierung welches Men√º angezeigt wird 
        eyes_closed: false,       // Orientierung f√ºr eine Aktion pro augen-zu 
        black_design : false,
        dbug: false,
      } },
      methods: {
        playBell(){
          //spielt das Ger√§usch der Schwesternglocke (iPhone-optimiert)
          try {
            console.log("Versuche Warnsignal zu starten...");
            
            // iPhone: Audio Context aktivieren
            if (!userInteracted) {
              enableAudio();
            }
            
            serviceBell.volume = 0.9;
            serviceBell.loop = true;
            
            // Promise-basierte Wiedergabe f√ºr moderne Browser
            const playPromise = serviceBell.play();
            
            if (playPromise !== undefined) {
              playPromise
                .then(() => {
                  console.log("Warnsignal erfolgreich gestartet");
                })
                .catch(error => {
                  console.error("Fehler beim Abspielen des Warnsignals:", error);
                  
                  // iPhone: Versuche Audio Context zu aktivieren
                  if (audioContext && audioContext.state === 'suspended') {
                    audioContext.resume().then(() => {
                      console.log("Audio Context f√ºr Warnsignal aktiviert");
                      serviceBell.play().catch(e => console.error("Warnsignal nach Audio Context fehlgeschlagen:", e));
                    });
                  } else {
                    // Fallback: Versuche es nochmal nach Benutzerinteraktion
                    serviceBell.play().catch(e => console.error("Fallback fehlgeschlagen:", e));
                  }
                });
            }
          } catch (error) {
            console.error("Fehler in playBell:", error);
          }
        },
        stopBell(){
          //stoppt das abspielen des Ger√§usches
          try {
            console.log("Stoppe Warnsignal...");
            serviceBell.pause();
            serviceBell.currentTime = 0; // Zur√ºckspulen
            console.log("Warnsignal gestoppt");
          } catch (error) {
            console.error("Fehler beim Stoppen des Warnsignals:", error);
          }
        },
        cngAusw(text){
          //√Ñndert die Auswahl des K√∂rperteiles im Schmerz-Men√º (Men√º 2 AUA)
          let ausgabe = document.getElementById("Auswahl");
          ausgabe.innerHTML = text;
        },
        cngGrad(text){
          let ausgabe = document.getElementById("GradSchmerz");
          ausgabe.innerHTML = text;
        },
        cngLeuchtgsw(sekunden){
          this.waittime = sekunden*1000;
        },
        cngHinweis(text){
          let meldung = document.getElementById("Hinweis");
          meldung.innerHTML = text + "wurde erfolgreich ge√§ndert.";
        },
        cngOrientierung(text){
          let aktuellesMenue = document.getElementById("orientierung");
          aktuellesMenue.innerHTML = text;
        },
        addChar(character){
          let nachricht = document.getElementById("msg");
          nachricht.value += character;
          // Nach Auswahl eines Buchstabens direkt auf die TTS/Pause-Zeile springen
          this.colorDiv('rowTTS', 3);
        },
        delChar(){
          //l√∂scht den letzten Buchstaben(!) der Nachricht (Men√º 3 NAC)
          let nachricht = document.getElementById("msg");
          nachricht.value = nachricht.value.slice(0, -1);
        },
        delallChar(){
          //l√∂scht die gesamte eingegebene Nachricht (Men√º 3 NAC)
          let nachricht = document.getElementById("msg");
          nachricht.value = "";
        },
        dayNight(){
          //√Ñndert den Farbmodus zum dunklen Design und wieder zur√ºck (Men√º 5 EIN)
          var element = document.body;
          element.classList.toggle("dark");
          this.black_design = !(this.black_design);
        },
        colorElement(elementID,menuValue){
          //Setzt einen Filter √ºber ein Element, damit es von schwarz zu Chocolate wird
          this.selectedElement = elementID;
          let elementToColour = document.getElementById(elementID);
          if((elementToColour) && (this.showMenu == menuValue)){
            //filter f√ºr die Farbe chocolate (#D2691E)
            elementToColour.style.filter= 'invert(59%) sepia(34%) saturate(5314%) hue-rotate(350deg) brightness(86%) contrast(90%)';
            
            // Text-to-Speech f√ºr spezielle Elemente im Nachrichtenmen√º
            if (this.showMenu == 3 || (this.showMenu >= 301 && this.showMenu <= 307)) {
              console.log('Element wird aktiv:', elementID, 'Menu:', this.showMenu);
              
              // Spezielle Behandlung f√ºr Leerzeichen-Zeilen
              if (elementID === "row5" || elementID === "row4") {
                // row5 bei Tastatur 0&2, row4 bei Tastatur 1 = Leerzeichen
                if (window.speechManager) {
                  window.speechManager.speak("Leerzeichen");
                }
              }
              // Spezielle Behandlung f√ºr L√∂sch-Zeilen  
              else if (elementID === "row6" || elementID === "row5") {
                // Diese Zeilen enthalten die L√∂sch-Buttons
                if (window.speechManager) {
                  window.speechManager.speak("L√∂sch-Optionen");
                }
              }
              // Spezielle Behandlung f√ºr Schnellzugriff-Zeilen
              else if (elementID === "row7" || elementID === "row6") {
                // Diese Zeilen enthalten Zahlen, Umgebung, Ich
                if (window.speechManager) {
                  window.speechManager.speak("Schnellzugriff");
                }
              }
            }
          }
        },
        colorDiv(elementID,menuValue){
          this.selectedElement = elementID;
          let elementToColour = document.getElementById(elementID);
          if((elementToColour) && (this.showMenu == menuValue)){
            //elementToColour.className += ' button_div'; 
            elementToColour.classList.add('button_div'); 
          }
        },
        colorButton(elementID, menuValue){
          this.selectedElement = elementID;
          let elementToColour= document.getElementById(elementID);
          if((elementToColour)&&(this.showMenu == menuValue)){
            elementToColour.style.backgroundColor='#FF1493'; // Rosa statt schwarz
            elementToColour.style.color='white'; // Wei√üer Text f√ºr Kontrast
            // Text-to-Speech f√ºr ALLE Nachrichtenmen√º-Bereiche
            if (this.showMenu == 3 || (this.showMenu >= 301 && this.showMenu <= 307) || (this.showMenu >= 3071 && this.showMenu <= 30720)) {
              const text = elementToColour.textContent || elementToColour.innerText;
              console.log('Button wird rosa/aktiv:', elementID, 'Text:', text, 'Menu:', this.showMenu);
              speakText(text);
            }
          }
        },
        blancElement(elementID, menuValue){
          //l√∂scht alle Filter √ºber einem Element
          let elementToBlanc = document.getElementById(elementID);
          if(elementToBlanc){
            if((this.showMenu == menuValue)){
              elementToBlanc.style.filter = 'none';
            }
            if((this.black_design)){
              elementToBlanc.style.filter='invert(100%)';
            }
          }
        },
        blancDiv(elementID, menuValue){
          //l√∂scht alle Filter √ºber einem Element
          let elementToBlanc = document.getElementById(elementID);
          if((elementToBlanc) && (this.showMenu == menuValue)){
            elementToBlanc.classList.remove('button_div');
          }
        },
        blancButton(elementID,menuValue){
          let elementToBlanc=document.getElementById(elementID);
          if((elementToBlanc) && (this.showMenu == menuValue)){
            elementToBlanc.style.backgroundColor = '#e7e7e7';
          }
        },
        colorListDiv(rows, listID , goBackID, menuValue){
          if (menuValue != this.showMenu){ return;}
          // Im Nachrichtenmen√º: Zyklus startet mit TTS-Button als Zeile 0
          if(this.showMenu==3){
            // TTS-Button als Zeile 0
            if(listID === 0){
              const ttsButton = document.getElementById('TTSButton');
              if(ttsButton){
                this.selectedElement = 'TTSButton';
                this.element = 'TTSButton';
                ttsButton.style.backgroundColor = '#FF1493';
                ttsButton.style.color = 'white';
                // KEIN automatisches Vorlesen mehr!
                setTimeout(()=>{
                  if (menuValue != this.showMenu){ return;}
                  ttsButton.style.backgroundColor = '#e7e7e7';
                  ttsButton.style.color = 'black';
                  this.colorListDiv(rows, listID+1, goBackID, menuValue);
                }, this.waittime);
                return;
              } else {
                // Falls Button nicht gefunden, direkt weiter
                this.colorListDiv(rows, listID+1, goBackID, menuValue);
                return;
              }
            }
            // rows.length+1 == listID: Go-Back-Button
            if(listID === rows.length+1){
              this.colorElement(goBackID,menuValue);
              setTimeout(()=>{
                this.blancElement(goBackID,menuValue);
                this.colorListDiv(rows,0,goBackID,menuValue);
              },this.waittime);
              return;
            }
            // 1 <= listID <= rows.length: normale Zeilen
            if(listID > 0 && listID <= rows.length){
              this.colorDiv(rows[listID-1],menuValue);
              setTimeout(()=>{
                this.blancDiv(rows[listID-1],menuValue);
                this.colorListDiv(rows, listID+1, goBackID, menuValue);
              },this.waittime);
              return;
            }
            return;
          }
          if(listID==(-1)){
            if(this.showMenu==3){
              if(this.selectedKeyboard==1){
                this.buttons=[];
                this.buttons.push("zuUmgebung","zuIch");
                this.colorListKeys(this.buttons,0,3,"row6",3);
                setTimeout(()=>{
                  if (menuValue != this.showMenu){ return;}
                  this.colorElement(goBackID,menuValue);
                  setTimeout(()=>{
                    if (menuValue != this.showMenu){ return;}
                    this.blancElement(goBackID,menuValue);
                    this.colorListDiv(rows,listID+1,goBackID,menuValue);
                  },this.waittime);
                },2*this.waittime);
              }else{
                this.buttons=[];
                this.buttons.push("Zahlen","zuUmgebung","zuIch");
                this.colorListKeys(this.buttons,0,3,"row7",3);
                setTimeout(()=>{
                  if (menuValue != this.showMenu){ return;}
                  this.colorElement(goBackID,menuValue);
                  setTimeout(()=>{
                    if (menuValue != this.showMenu){ return;}
                    this.blancElement(goBackID,menuValue);
                    this.colorListDiv(rows,listID+1,goBackID,menuValue);
                  },this.waittime);
                },3*this.waittime);
              }
            }else{
              this.colorElement(goBackID,menuValue);
                setTimeout(()=>{
                  this.blancElement(goBackID,menuValue);
                  this.colorListDiv(rows,listID+1,goBackID,menuValue);
                },this.waittime);
              }
          }
          if (menuValue != this.showMenu){ return;}
          if(rows.length==listID-1){
            // Nach den normalen Zeilen die TTS-Buttons durchlaufen
            if (this.showMenu == 3) {
              this.colorTTSButtons(menuValue);
            } else {
              listID=-1;
              this.colorListDiv(rows,listID,goBackID,menuValue);
            }
          }
          if (menuValue != this.showMenu){ return;}
          if(listID!=(-1)){
            this.colorDiv(rows[listID-1],menuValue);
            
            // Text-to-Speech f√ºr Div-Zeilen im Nachrichtenmen√º
            if (this.showMenu == 3) {
              const rowId = rows[listID-1];
              console.log('Div-Zeile wird aktiv:', rowId, 'Menu:', this.showMenu);
              
              // Bestimme was in dieser Zeile ist
              if ((rowId === "row5" && this.selectedKeyboard !== 1) || (rowId === "row4" && this.selectedKeyboard === 1)) {
                speakText("Leerzeichen");
              } else if ((rowId === "row6" && this.selectedKeyboard !== 1) || (rowId === "row5" && this.selectedKeyboard === 1)) {
                // Statt "L√∂sch-Optionen" die einzelnen Buttons durchlesen
                setTimeout(() => {
                  speakText("L√∂schen");
                }, 500);
                setTimeout(() => {
                  speakText("Alles L√∂schen");
                }, 1500);
              } else if ((rowId === "row7" && this.selectedKeyboard !== 1) || (rowId === "row6" && this.selectedKeyboard === 1)) {
                speakText("Schnellzugriff");
              }
            }
            
            setTimeout(()=>{
              // Nur fortfahren wenn nicht pausiert
              if (!this.isPaused) {
                this.blancListDiv(rows, listID, goBackID, menuValue);
              }
            },this.waittime)
          }
        },
        blancListDiv(rows, listID, goBackID, menuValue){
          this.blancDiv(rows[listID-1],menuValue);

          this.colorListDiv(rows, listID +1 , goBackID, menuValue);
        },
        colorListKeys(keys,listID,menuValue,outsideDiv,menuBack){
          if (menuValue != this.showMenu){ return;}

          if(keys.length==listID){
            this.blancDiv(outsideDiv,menuValue);
            this.showMenu=menuBack;
          }

          if (menuValue != this.showMenu){ return;}

          this.colorButton(keys[listID],menuValue);
          
          // Text-to-Speech f√ºr ALLE Nachrichtenmen√º-Bereiche
          if (this.showMenu == 3 || (this.showMenu >= 301 && this.showMenu <= 307) || (this.showMenu >= 3071 && this.showMenu <= 30720)) {
            const text = keys[listID];
            console.log('Taste wird aktiv:', keys[listID], 'Text:', text, 'Menu:', this.showMenu);
            speakText(text);
          }
          
          setTimeout(()=>{
            // Nur fortfahren wenn nicht pausiert
            if (!this.isPaused) {
              this.blancButton(keys[listID], menuValue);
              this.colorListKeys(keys, listID +1 , menuValue, outsideDiv, menuBack);
            }
          },this.waittime)
        },
        colorListButtons(buttons,listID,goBackID,menuValue){
          if(listID==(-1)){
            this.colorElement(goBackID,menuValue);
            setTimeout(()=>{
              this.blancElement(goBackID,menuValue);
              this.colorListButtons(buttons,listID+1,goBackID,menuValue);
            },(this.waittime));
          };

          if (menuValue != this.showMenu){ return;}
          if(buttons.length==listID-1){
            listID=-1;
            this.colorListButtons(buttons,listID,goBackID,menuValue);
          }
          if (menuValue != this.showMenu){ return;}
          if(listID!=(-1)){
            this.colorButton(buttons[listID-1],menuValue);
            
            // Text-to-Speech f√ºr Buttons in Nachrichtenmen√º hinzuf√ºgen
            if (this.showMenu == 3 || (this.showMenu >= 301 && this.showMenu <= 307) || (this.showMenu >= 3071 && this.showMenu <= 30720)) {
              const text = buttons[listID-1];
              console.log('Button wird aktiv:', buttons[listID-1], 'Text:', text, 'Menu:', this.showMenu);
              speakText(text);
            }
            
            setTimeout(()=>{
              // Nur fortfahren wenn nicht pausiert
              if (!this.isPaused) {
                this.blancButton(buttons[listID-1], menuValue);
                this.colorListButtons(buttons,listID+1,goBackID,menuValue);
              }
            },this.waittime)
          }
        },
        colorListPictures(pictures,listID,menuValue){
          if (menuValue != this.showMenu){ return;}
           if(pictures.length==listID-1){
            listID=-1;
            this.colorListPictures(pictures,listID+1,menuValue);
          }
          if(listID!=(-1)){
            this.colorElement(pictures[listID-1],menuValue);
            setTimeout(()=>{
              // Nur fortfahren wenn nicht pausiert
              if (!this.isPaused) {
                this.blancElement(pictures[listID-1], menuValue);
                this.colorListPictures(pictures, listID +1 , menuValue);
              }
            },this.waittime)
          }
        }, 
        detectEyesOpen (landmarks){
          //Funktion zum erkennen, ob die Augen offen oder geschlossen sind.
          //F√ºr jedes geschlossene Frame wird variable "closed_frames" hochgez√§hlt
          //Wenn "closed_frames" den Wert von "time_closed" erreicht => Aktion

          let faceheight = landmarks[152].y-landmarks[10].y; //bestimme Gesichtsh√∂he
          let facewidth = landmarks[10].x-landmarks[152].x;  //bestimme Gesichtsbreite
          var facesize; //Orientierung wie gro√ü das gesicht im Bilderrahmen ist
          var eye_right_one;  //Abstand zwischen den 1. & 2. Punkten rechts
          var eye_right_two;  //Abstand zwischen den 3. & 4. Punkten rechts
          var eye_left_one;   //Abstand zwischen den 1. & 2. Punkten links
          var eye_left_two;   //Abstand zwischen den 3. & 4. Punkten links
          var right_eye;  //Rechtes Auge Offen (0) oder zu (1)
          var left_eye;   //Linkes Auge offen (0) oder zu (1)

          //Abstandsberechnung der Gesichts-Landmarks abh√§ngig von Orientierung des Bildes
          if (faceheight < facewidth){
            //gesichtsmitte ist parallel zu x-Achse ->
            facesize = facewidth;
            eye_right_one = landmarks[160].x-landmarks[144].x;
            eye_right_two = landmarks[159].x-landmarks[145].x;
            eye_left_one = landmarks[387].x-landmarks[373].x;
            eye_left_two = landmarks[386].x-landmarks[374].x;
          } else {
            //Gesichtsmitte ist parallel zu y-Achse ^
            facesize = faceheight;
            eye_right_one = landmarks[144].y-landmarks[160].y;
            eye_right_two = landmarks[145].y-landmarks[159].y;
            eye_left_one = landmarks[373].y-landmarks[387].y;
            eye_left_two = landmarks[374].y-landmarks[386].y;
          }

          //Berechnung ob Augen zu sind anhand der Gesichtsgr√∂√üe und einem 
          // experimentellen faktor. Zur Sicherheit: zwei Abst√§nde pro Auge
          if ((eye_right_one*facefactor < facesize)&&(eye_right_two*facefactor < facesize)){
            right_eye = "1" //rechtes Auge ist geschlossen
          } else{
            right_eye = "0" //rechtes Auge ist offen
          }
          
          if ((eye_left_one*facefactor < facesize)&&(eye_left_two*facefactor< facesize)){
            left_eye = "1" //linkes Auge ist geschlossen
          } else{
            left_eye = "0" //linkes Auge ist offen
          }
          
          // Wenn beide Augen geschlossen sind werden die Frames hochgez√§hlt.
          // wenn 1 oder beide AUgen offen sind, werden die Frames auf 0 gesetzt
          // und ab dann darf wieder geblinzelt werden (eyes_closed= false)
          if((right_eye == "1") && (left_eye == "1")){
            this.closed_frames = this.closed_frames+1;
            this.wanted_time_closed = this.closed_frames;
          } else {
            this.closed_frames =0;

            // wenn gerade die Augenzeit eingestellt werden soll
            if (this.cngTime_closed){
              this.time_closed = this.wanted_time_closed;
              if(this.dbug){
                console.log(" ge√§nderte tiem_ clsoed: " + this.time_closed);
              }
              this.cngTime_closed=false;

                //falls man sich auf der Startseite befindet: 
                // nach einstellung auf hauptmen√º wechseln
              if(this.showMenu == (-1)){ 
                // Nur zur Haupt-App wechseln, wenn Kamera funktioniert
                // this.showMenu=0; // Entfernt - automatischer Wechsel deaktiviert
              }
            }
            this.eyes_closed = false;
          }
          if(this.closed_frames == 1){
            this.element = this.selectedElement;
          }

          if(this.dbug){
            console.log(this.closed_frames);
          }

          //Wenn bede Augen entsprechend lange zu waren, f√ºhre die Klick-aktion aus,
          //die hinterlegt ist am ausgew√§hlten Element (@click von vue)
          if ((this.closed_frames >= time_closed) && (!this.eyes_closed) && (document.getElementById(this.element))){
            if(this.dbug){
              console.log("got action at ", this.element);
            }
            
            // Wenn TTSButton per Blinzeln ausgew√§hlt wird, Textfeld vorlesen
            if(this.element === 'TTSButton'){
              const msg = document.getElementById('msg').value;
              if(window.speechSynthesis && msg && msg.trim().length > 0){
                window.speechSynthesis.cancel();
                if(typeof isSpeaking !== 'undefined') isSpeaking = false;
                const utter = new window.SpeechSynthesisUtterance(msg);
                window.speechSynthesis.speak(utter);
              } else {
                speakText('Text vorlesen');
              }
              this.eyes_closed = true;
              return;
            }
            
            // Pause-Funktionalit√§t pr√ºfen
            if (this.pauseRequested && !this.isPaused) {
              // Pause aktivieren
              this.isPaused = true;
              this.pauseRequested = false;
              this.currentPauseElement = this.element;
              console.log("Pause activated at element:", this.element);
              
              // Button-Text √§ndern
              const pauseButton = document.getElementById("PauseButton");
              if (pauseButton) {
                pauseButton.innerHTML = "‚ñ∂Ô∏è Fortsetzen";
                pauseButton.style.backgroundColor = "#90EE90"; // Hellgr√ºn f√ºr "Fortsetzen"
              }
              
              // Keine weitere Aktion ausf√ºhren
              this.eyes_closed = true;
              return;
            }
            
            if (this.isPaused && this.pauseRequested === false) {
              // Pause beenden und genau dort weitermachen, wo pausiert wurde
              this.isPaused = false;
              this.pauseRequested = false;
              console.log("Pause ended - continuing from where we left off");
              
              // Button-Text √§ndern
              const pauseButton = document.getElementById("PauseButton");
              if (pauseButton) {
                pauseButton.innerHTML = "‚è∏Ô∏è Pause";
                pauseButton.style.backgroundColor = "#e7e7e7"; // Normale Farbe
              }
              
              // Keine weitere Aktion ausf√ºhren - die normale Zyklierung l√§uft weiter
              this.eyes_closed = true;
              return;
            }
            
            // Normale Aktion ausf√ºhren
            const element = document.getElementById(this.element);
            if (element) {
              element.click();
              console.log("Aktion ausgef√ºhrt:", this.element);
            } else {
              console.warn("Element nicht gefunden:", this.element);
            }
            this.eyes_closed = true; 
            // Sobald die Aktion ausgef√ºhrt wurde darf nicht sofort eine neue erfolgen
            // Dies verhindert auch st√§ndiges ausw√§hlen beim schlafen (test erforderlich)
          }
        },
        Frame_Abhandlung(results) {
          //Funktion, die nach jedem empfangenen Frame mit Gesicht dieses analysiert 
          //mit detectEyesOpen()
          if (results.multiFaceLandmarks) {
            for (const landmarks of results.multiFaceLandmarks) {
              this.detectEyesOpen(landmarks);
            }
          }
        },
        debug (event) {
          console.log(event)
        },
        readTextFromMessageBox() {
          const msg = document.getElementById("msg").value;
          speakText(msg);
        },
        restartCurrentMenu() {
          // Zur√ºck zum Hauptmen√º (Home-Icon) statt aktuelles Men√º neu starten
          console.log("Restarting from main menu (Home-Icon)");
          this.showMenu = 0; // Zur√ºck zum Hauptmen√º
        },
        colorTTSButtons(menuValue) {
          // Nur noch den Text vorlesen-Button durchlaufen
          const ttsButtons = ["TTSButton"];
          let currentButtonIndex = 0;
          
          const cycleTTSButtons = () => {
            if (menuValue != this.showMenu) { return; }
            
            if (currentButtonIndex >= ttsButtons.length) {
              // Mit der ersten Tastatur-Zeile weitermachen
              this.continueWithFirstRow();
              return;
            }
            
            const buttonId = ttsButtons[currentButtonIndex];
            const button = document.getElementById(buttonId);
            
            if (button) {
              // Aktives Element f√ºr Blinzel-Logik setzen
              this.selectedElement = buttonId;
              this.element = buttonId;
              // Button hervorheben (jetzt pink wie andere aktive Felder)
              button.style.backgroundColor = '#FF1493';
              button.style.color = 'white';
              
              // TTS f√ºr Button-Text
              const buttonText = button.textContent || button.innerText;
              speakText(buttonText);
              
              setTimeout(() => {
                if (menuValue != this.showMenu) { return; }
                
                // Button zur√ºcksetzen
                button.style.backgroundColor = '#e7e7e7';
                button.style.color = 'black';
                
                // N√§chster Button
                currentButtonIndex++;
                cycleTTSButtons();
              }, this.waittime);
            } else {
              // Button nicht gefunden, zum n√§chsten
              currentButtonIndex++;
              cycleTTSButtons();
            }
          };
          
          cycleTTSButtons();
        },
        continueWithFirstRow() {
          // Mit der ersten Tastatur-Zeile weitermachen
          this.selectedKeyboard = 0;
          this.showMenu = 3;
          this.cngOrientierung("Nachricht");
          this.rows = [];
          for (let i = 0; i < (this.Keyboards[this.selectedKeyboard].length + 2); i++) {
            this.rows.push('row' + i);
          }
          this.colorListDiv(this.rows, 0, "GoHome", 3);
        }
      },
      watch:{
        //√Ñnderung von der Variable showMenu (=> wechseln des Men√ºs) f√ºhrt hierher
        showMenu(){
          console.log(this.showMenu);
          switch (this.showMenu){
          // --- Hauptmen√º
            case 0:  
              this.cngOrientierung("Ratatosk"); 
              this.elements=["SOS","AUA","NAC","UMG","SEL","EIN"];
              this.colorListPictures(this.elements,0,0); break; 

          // --- Warnruf-Men√º
            case 1: 
              this.cngOrientierung("Warnruf");  
              this.elements=["Bell_silent","GoHome"];
              this.colorListPictures(this.elements,0,1); break; 
            case 101: this.elements=["Bell_active","GoHome"];
              this.colorListPictures(this.elements,0,101);break;   

          // --- Schmerz-Men√º
            case 2: this.cngOrientierung("Schmerzen"); 
              this.elements=["Kopf","Torso","Arme","Beine","GoHome"];
              this.colorListPictures(this.elements,0,2); break;

              //Untermen√ºs Kopf(201), Torso(202), Arme(203), Beine(204)
            case 201: case 202: case 203: case 204: 
              this.rows = []; 
              for (let i = 0; i < (this.Schmerz[this.showMenu-201].length); i++) 
                {this.rows.push('Schmerz'+i);};
              this.rows.push('Skala');
              this.colorListDiv(this.rows,0,"GoBackAUA", this.showMenu);
             break; 

              //Zeilen in den Untermen√ºs
            case 2011: case 2012: case 2013: case 2014:     //Zeilen in Kopf
            case 2021: case 2022: case 2023:                //Zeilen in Torso
            case 2031: case 2032: case 2033:                //Zeilen in Arme
            case 2041: case 2042: case 2043:                //Zeilen in Beine
              this.buttons=[];
              // Berechnet die Zehnerstelle: (welches Untermen√º wurde genommen)
              this.subMenuValue=Math.floor((this.showMenu/10) %10);
              // berechnet die Einerstelle: (welche Zeile wird genommen)
              this.LineMenuValue=Math.floor(this.showMenu %10);
              for (let i = 0; i < (this.Schmerz[this.subMenuValue-1][this.LineMenuValue-1].length ); i++) 
                {this.buttons.push(this.Schmerz[this.subMenuValue-1][this.LineMenuValue-1][i]);};
              this.colorListKeys(this.buttons,0,this.showMenu,("Schmerz"+(this.LineMenuValue-1)),this.subMenuValue+200); break;

            case 20001: 
              this.buttons=[];
              for (let i = 0; i < (this.Schmerzskala.length ); i++) 
                {this.buttons.push(this.Schmerzskala[i]);};
              this.colorListButtons(this.buttons,0,"GoBackAUA",20001);
              break;

          // --- Nachrichten-Men√º
            case 3: this.cngOrientierung("Nachricht");
              this.rows = []; 
              for (let i = 0; i < (this.Keyboards[this.selectedKeyboard].length+2); i++) 
                {this.rows.push('row'+i);};
              this.colorListDiv(this.rows,0,"GoHome", 3);  
              break;
            case 301: case 302: case 303: case 304: // Erste 4 Zeilen der Tastaturen
              this.keys =[];           
              // berechnet die Einerstelle: (welche Zeile wird genommen)
              this.LineMenuValue=Math.floor(this.showMenu %10);
              this.Idname="row"+(this.LineMenuValue-1);
              for (let i = 0; i < (this.Keyboards[this.selectedKeyboard][this.LineMenuValue-1].length ); i++) 
                {this.keys.push(this.Keyboards[this.selectedKeyboard][this.LineMenuValue-1][i]);};
              this.colorListKeys(this.keys,0,this.showMenu,this.Idname,3); break;
            case 305: // Tastatur '1'(QWERTZ) hat als 5. Zeile die Leertaste (kein Untermen√º 305)
              if(this.selectedKeyboard !=1){
              this.keys=[];
              for (let i = 0; i < (this.Keyboards[this.selectedKeyboard][4].length ); i++) 
                {this.keys.push(this.Keyboards[this.selectedKeyboard][4][i]);};
              this.colorListKeys(this.keys,0,305,"row4",3);
              }; break;
            case 306: // Tast. '0'&'2': 6. Zeile Leertaste (kein Untermen√º 306), Tast. '1' hat hier'L√∂schen'
              if(this.selectedKeyboard == 1){
              this.keys=[];
              this.keys.push("L√∂schen","AllesLoschen");
              this.colorListKeys(this.keys,0,306,"row5",3); 
              this.blancDiv("row5",306);};
              break;

            case 307: //Tast. '0'&'2': 6. Zeile 'L√∂schen', Tastatur '1' hat Schnellbau-Buttons (kein Untermen√º)
              if(this.selectedKeyboard != 1){
              this.keys=[];
              this.keys.push("L√∂schen","AllesLoschen");
              this.colorListKeys(this.keys,0,307,"row6",3);};
              break;

            case 3071: this.rows=[]; 
              for (let i = 0; i < (this.ZahlenMenu .length ); i++) 
                {this.rows.push("numpad"+ i);};
              this.colorListDiv(this.rows,0,"GoBackNachricht", 3071); 
              break;
            case 30711: case 30712: case 30713: case 30714:
              this.keys =[];           
              // berechnet die Einerstelle: (welche Zeile wird genommen)
              this.LineMenuValue=Math.floor(this.showMenu %10);
              this.Idname="numpad"+(this.LineMenuValue-1);
              for (let i = 0; i < (this.ZahlenMenu[this.LineMenuValue-1].length ); i++) 
                {this.keys.push(this.ZahlenMenu[this.LineMenuValue-1][i]);};
              this.colorListKeys(this.keys,0,this.showMenu,this.Idname,3071); break;

          // --- Schnellbausteine 'Umgebung'-Men√º
            case 4: this.cngOrientierung("Schnellbausteine 'Umgebung'"); 
              this.buttons=[]; 
              this.buttons.push("Gespr√§ch","Gegenst√§nde","ImZimmer","ImBett");
              this.colorListButtons(this.buttons,0,"GoHome",4); break;

              // Untermen√ºs Gespr√§ch(401), Gegenst√§nde(402), Im_Zimmer(403), Im_Bett(404)
            case 401: case 402: case 403: case 404: 
              this.rows = []; 
              for (let i = 0; i < (this.UmgebungMenu[this.showMenu-401].length); i++) 
                {this.rows.push('Umwelt'+i);};
              this.rows.push("GoToNachricht");
              this.colorListDiv(this.rows,0,"GoBackUmgebung", this.showMenu);
              break;

              //Zeilen in den Untermen√ºs
            case 4011: case 4012: case 4013: case 4014: case 4015: //Gespr√§ch-Zeilen
            case 4021: case 4022: case 4023:                       //Gegenst√§nde-Zeilen
            case 4031: case 4032: case 4033:                       //Im Zimmer-Zeilen
            case 4041: case 4042:                                  //Im Bett-Zeilen
              this.buttons=[];
              // Berechnet die Zehnerstelle: (welches Untermen√º wurde genommen)
              this.subMenuValue=Math.floor((this.showMenu/10) %10);
              // berechnet die Einerstelle: (welche Zeile wird genommen)
              this.LineMenuValue=Math.floor(this.showMenu %10);
              for (let i = 0; i < (this.UmgebungMenu[this.subMenuValue-1][this.LineMenuValue-1].length ); i++) 
                {this.buttons.push(this.UmgebungMenu[this.subMenuValue-1][this.LineMenuValue-1][i]);};
              this.colorListKeys(this.buttons,0,this.showMenu,("Umwelt"+(this.LineMenuValue-1)),this.subMenuValue+400); break;

          // --- Schnellbausteine 'Ich'-Men√º
            case 5: this.cngOrientierung("Schnellbausteine 'Ich'"); 
              this.buttons=[]; 
              this.buttons.push("Ern√§hrung","Gef√ºhle","Kleidung", "Hygiene","Bewegung");
              this.colorListButtons(this.buttons,0,"GoHome",5); break;

              // Untermen√ºs Ern√§hrung(501), Gef√ºhle(502), Kleidung(503), Hygiene(504), Bewegung(505)
            case 501: case 502: case 503: case 504: case 505:
              this.rows = []; 
              for (let i = 0; i < (this.IchMenu[this.showMenu-501].length); i++) 
                {this.rows.push('Ich'+i);};
              this.rows.push("GoToNachricht");
              this.colorListDiv(this.rows,0,"GoBackIch", this.showMenu);
              break;

              // Zeilen in den Untermen√ºs
            case 5011: case 5012: case 5013: case 5014: case 5015: //Ern√§hrung-Zeilen
            case 5021: case 5022: case 5023: case 5024: case 5025: case 5026: case 5026://Gef√ºhle-Zeilen
            case 5031: case 5032: case 5033:                       //Kleidung-Zeilen
            case 5041: case 5042:                                  //Hygiene-Zeilen
            case 5051: case 5052: case 5053: case 5054:            //Bewegung-Zeilen
              this.buttons=[];
              // Berechnet die Zehnerstelle: (welches Untermen√º wurde genommen)
              this.subMenuValue=Math.floor((this.showMenu/10) %10);
              // berechnet die Einerstelle: (welche Zeile wird genommen)
              this.LineMenuValue=Math.floor(this.showMenu %10);
              for (let i = 0; i < (this.IchMenu[this.subMenuValue-1][this.LineMenuValue-1].length ); i++) 
                {this.buttons.push(this.IchMenu[this.subMenuValue-1][this.LineMenuValue-1][i]);};
              this.colorListKeys(this.buttons,0,this.showMenu,("Ich"+(this.LineMenuValue-1)),this.subMenuValue+500); break;

          // --- Einstellungs-Men√º
            case 6: this.cngOrientierung("Einstellungen"); this.buttons=[]; 
              this.buttons.push("Tastaturdesign","Leuchtgeschwindigkeit","Blinzeldauer", "Farbmodus");
              this.colorListButtons(this.buttons,0,"GoHome",6); break;

            case 601: this.rows = []; 
              this.rows.push("Alphabetisch","Quertz","H√§ufigkeit");
              this.colorListButtons(this.rows,0,"GoHome", 601);  
              break;

            case 602:  this.rows = []; 
              for (let i = 0; i < (this.Blinkzeiten.length); i++) 
                {this.rows.push('speed'+ this.Blinkzeiten[i]);};
              this.colorListButtons(this.rows,0,"GoHome", 602);
              break;

            case 603: //this.colorButton("BerechnenBlinzeln",603); 
              this.buttons=[];
              this.buttons.push("BerechnenBlinzeln");
              this.colorListButtons(this.buttons,0,"GoHome",603);
               break;

            case 6031: this.blancButton("BerechnenBlinzeln",6031); break;

          // --- F√ºr unerwartete/undeffinierte Men√º-Werte: zur√ºck zum Hauptmen√º (app l√§uft davon aus normal weiter)
            default: this.showMenu=0; break;
          }
        }
      }
    })

    const root = element_click.mount('#element_click'); 

    //neues Facemesh √∂ffnen
    const faceMesh = new FaceMesh({locateFile: (file) => {
      return `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${file}`;
    }});
    faceMesh.setOptions({
      maxNumFaces: 1,
      refineLandmarks: true,
      minDetectionConfidence: 0.5,
      minTrackingConfidence: 0.5
    });

    function handle_result(landmarks) {
      root.Frame_Abhandlung(landmarks);
    }

    faceMesh.onResults(handle_result);

    const camera = new Camera(videoElement, {
      onFrame: async () => {
        await faceMesh.send({image: videoElement});
      },
      width: 640,
      height: 480,
      facingMode: "user"
    });

    // Verbesserte Kamera-Initialisierung f√ºr mobile Ger√§te (iPhone-kompatibel)
    async function initializeCamera() {
      try {
        console.log("=== KAMERA-INITIALISIERUNG STARTET ===");
        
        // Verwende die verbesserte initCamera Funktion
        const success = await initCamera();
        
        if (success) {
          console.log("‚úÖ Kamera erfolgreich initialisiert");
          
          // Pr√ºfe ob Camera-Utils verf√ºgbar ist
          if (typeof camera !== 'undefined' && camera && camera.start) {
            console.log("üéØ Starte Camera-Utils...");
            camera.start();
            console.log("‚úÖ Camera-Utils gestartet");
          } else {
            console.warn("‚ö†Ô∏è Camera-Utils nicht verf√ºgbar");
          }
          
          console.log("üéâ KAMERA ERFOLGREICH INITIALISIERT!");
          
          // Nur wenn Kamera funktioniert, zur Haupt-App wechseln
          if (element_click && element_click.$data) {
            element_click.$data.showMenu = 0;
            console.log("üîÑ Wechsle zur Haupt-App - Kamera funktioniert");
          } else {
            console.warn("‚ö†Ô∏è Vue-App nicht verf√ºgbar f√ºr Men√º-Wechsel");
          }
        } else {
          throw new Error("Kamera-Initialisierung fehlgeschlagen");
        }
        
      } catch (error) {
        console.error("‚ùå KAMERA-INITIALISIERUNG FEHLGESCHLAGEN:", error);
        
        // Bleibe auf Startseite
        console.log("üè† Bleibe auf Startseite, Kamera nicht verf√ºgbar");
      }
    }

    // Kamera beim Laden initialisieren
    console.log("üöÄ Starte automatische Kamera-Initialisierung...");
    initializeCamera();

    //Array mit allen Bildern, die vorgeladen werden m√ºssen
    vorladen("./Ratatosk.svg","./GoHome.svg","./Goback.svg", // Sonstiges
      "./Glocke.svg","./Glockenschlag.svg",   //SOS Men√º
      "./Arme.svg","./Beine.svg","./Kopf.svg","./Torso.svg", //Schmerz-Men√º
      "./Einstellungen.svg","./Ich.svg","./Nachricht.svg","./Schmerz.svg","./Umgebung.svg"  //Mainmen√º
      );
  </script>

  <div>

    <!-- Oberer Teil der Seite -->
      <header >
        <img src="./Ratatosk.svg" width="80vw" height="20vh" alt="Logo" filter='none' style="color:white"></img> 
        <!-- <span class="site_name">Ratatosk</span> -->
        <p id="orientierung" class="site_name" style="margin:auto; font-size: 5.5vmin;">Ratatosk</p>
        <hr style="color:var(--maincolor);margin-left:0;width:80%;margin:auto;">
      </header>

    <div id="element_click">
    <!-- Zur√ºck / Text oben-->
      <div>
          <!-- Haus f√ºr "Zur√ºck zum Hauptmen√º" -->
            <div class="smallContainer" v-if="(showMenu >= 1 && showMenu < 200) ||((showMenu>300)&&(showMenu<400)) || ((showMenu>600)&&(showMenu<700))">
              <img id="GoHome" class= "smallPicture" src="./GoHome.svg" alt="Hauptmen√º" @click="showMenu=0; stopBell()"/>
            </div>

          <!-- Pfeil f√ºr "zur√ºck zum Schmerzmen√º / K√∂rper-Untermen√º" -->
            <div class="smallContainer" v-if="((showMenu > 200) && (showMenu < 300))||((showMenu>=2010)&&(showMenu<=2050))||(showMenu==20001)">
              <img id="GoBackAUA" class= "smallPicture"  src="./Goback.svg" alt="Zur√ºck" @click="showMenu=2"/>
            </div>

            <!-- Pfeil f√ºr "zur√ºck zum Nachrichten-Men√º" --> 
            <div class="smallContainer" v-if="((showMenu>30710)&&(showMenu<30720))||((showMenu==3071))">
              <img id="GoBackNachricht" class="smallPicture"  src="./Goback.svg" alt="Zur√ºck" @click="showMenu=3"/>
            </div>

           <!-- Pfeil f√ºr "zur√ºck zum Schnellbaustein-Men√º Ich/Umgebung" --> 
            <div class="smallContainer" v-if="((showMenu>500)&&(showMenu<600))||((showMenu>5000)&&(showMenu<6000))">
              <img id="GoBackIch" class="smallPicture"  src="./Goback.svg" alt="Zur√ºck" @click="showMenu=5"/>
            </div>
            <div class="smallContainer" v-if="((showMenu>400)&&(showMenu<500))||((showMenu>4000)&&(showMenu<5000))">
              <img id="GoBackUmgebung" class="smallPicture"  src="./Goback.svg" alt="Zur√ºck" @click="showMenu=4"/>
            </div>


          <!-- Text f√ºr Schmerzmen√º-Auswahl -->
            <div v-if="((200 < showMenu)&&(showMenu < 300))||((2010 < showMenu)&&(showMenu < 2050))||(showMenu==20001)" class="site_name" style="width:90%; display:inline-block; text-align: center;">
              <i>Ursprung des Schmerzes: </i>
              <i id="Auswahl"></i>
            </div>

            <div v-if="showMenu==20001" class="site_name" style="width:70%; display:inline-block;text-align: center;">
              <i> Grad des Schmerzes: </i>
              <i id="GradSchmerz"></i>
            </div>


          <!-- Textbox & Strich f√ºr Nachrichten-Men√º und Schnellbausteine-Men√ºs-->
            <div v-if="((showMenu>2)&&(showMenu<6)) || ((showMenu >300) && (showMenu < 600))|| ((showMenu>3000)&&(showMenu<6000))||((showMenu > 30710)&&(showMenu<30720))">
              <textarea id="msg" class="messagebox"></textarea>
              <hr style="color:var(--maincolor);margin-left:0;width:80%;margin:auto;margin-top:0.4%;margin-bottom:0.4%;">
              
              <!-- TTS-Button f√ºr Textfeld -->
              <div class="keydesign" style="width: 99%; margin-top: 10px;">
                <button id="TTSButton" class="KeyboardButton" @click="readTextFromMessageBox()" style="width: 48%; font-size: 1.2em; padding: 10px; margin-right: 2%;">
                  Text vorlesen
                </button>
              </div>
            </div>

      </div>

    <!-- Startseite -->
      <div class="site_name" v-if="showMenu==(-1)" style="text-align: center; display:block; margin: auto;">
        <div>Blinzeln Sie zum Starten</div>
          <img id="Start" class="startimage" src="./Ratatosk.svg" alt="Logo" @click="cngTime_closed=true; initializeCamera()" style="color:white"/>
          <div style="margin-top: 20px;">
            <button @click="initializeCamera()" style="background-color: var(--maincolor); color: white; border: none; padding: 10px 20px; border-radius: 8px; font-size: 1.2em; margin-right: 10px;">
              üì∑ Kamera aktivieren
            </button>
            <button @click="enableAudio()" style="background-color: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-size: 1.2em; margin-right: 10px;">
              üîä Audio aktivieren
            </button>
            <button id="PauseButton" @click="pauseRequested = true; isPaused = !isPaused;" style="background-color: #e7e7e7; color: black; border: none; padding: 10px 20px; border-radius: 8px; font-size: 1.2em;">
              ‚è∏Ô∏è Pause
            </button>
          </div>
        </div>

    <!-- Haupt Men√º -->
    <div class="container" v-if="showMenu==0">
        <div class="group">
          <img id="SOS" src="./Glocke.svg" alt=" Warnton " @click="showMenu=1"/>
          <p> Warnger√§usch </p>
        </div>
        <div class="group">
          <img id="AUA" src="./Schmerz.svg" alt=" Schmerz " @click="showMenu=2"/>
          <p> Schmerzen </p>
        </div>
        <div  class="group">
          <img id="NAC" src="./Nachricht.svg" alt=" Nachricht " @click="showMenu=3"/>
          <p> Nachricht </p>
        </div>
        <div class="group">
        <img id="UMG" src="./Umgebung.svg" alt=" Schnellbausteine Umgebung " @click="showMenu=4"/>
          <p> Umgebung </p>
        </div>
        <div class="group">
          <img id="SEL" src="./Ich.svg" alt=" Schnellbausteine Selbst " @click="showMenu=5"/>
          <p> Ich </p>
        </div>
        <div class="group">
        <img id="EIN" src="./Einstellungen.svg" alt=" Einstellungen " @click="showMenu=6"/>
          <p> Einstellung </p>
        </div>
      </div>

    <!-- Schwesternruf Men√º -->
    <div v-if="(showMenu==1)||(showMenu==101)" class="container" style="columns: 100px 1;">
      <div style="display:flex; width:80%;margin: auto;" class="group">
        <img id="Bell_silent" v-if="showMenu==1" style="width: 20%;margin: auto;align-self: center;" src="./Glocke.svg" alt="Lautsprecher" @click="playBell(); showMenu=101"/>
        <img id="Bell_active" v-if="showMenu==101" style="width: 20%;margin: auto;align-self: center;" src="./Glockenschlag.svg" alt="aktiver Lautsprecher" @click="showMenu=1; stopBell()"/>
      </div>
    </div>

    <!-- Schmerz Men√º -->
     <div v-if="showMenu==2" class="container" style="display:flex;flex-flow: row wrap;">
        <div class="group" style="width:40vw; height:35vh">
          <img id="Kopf" src="./Kopf.svg" alt=" Kopf " @click="showMenu=201"/>
          <p> Kopf </p>
        </div>
        <div class="group" style="width:40vw; height:35vh">
          <img id="Torso" src="./Torso.svg" alt=" Torso " @click="showMenu=202"/>
          <p> Torso </p>
        </div>
        <div class="group" style="width:40vw; height:35vh">
          <img id="Arme" src="./Arme.svg" alt=" Arme " @click="showMenu=203"/>
          <p> Arme </p>
        </div>
        <div class="group" style="width:40vw; height:35vh">
          <img id="Beine" src="./Beine.svg" alt=" Beine " @click="showMenu=204"/>
          <p> Beine </p>
        </div>
      </div>

        <!-- KopfSchmerz -->
      <div v-for="(rows, index) in Schmerz[0]" v-if="(showMenu==201)||((showMenu>2010)&&(showMenu<2020))" :id="'Schmerz' + index" class="SelectRow" @click="showMenu=2010 + (index+1)">
        <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="cngAusw(symbol); showMenu=201">{{ symbol }}</button>
      </div>
        <!-- TorsoSchmerz -->
      <div v-for="(rows, index) in Schmerz[1]" v-if="(showMenu==202)||((showMenu>2020)&&(showMenu<2030))" :id="'Schmerz' + index" class="SelectRow" @click="showMenu=2020 + (index+1)">
        <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="cngAusw(symbol); showMenu=202">{{ symbol }}</button>
      </div>
        <!-- ArmSchmerz -->
      <div v-for="(rows, index) in Schmerz[2]" v-if="(showMenu==203)||((showMenu>2030)&&(showMenu<2040))" :id="'Schmerz' + index" class="SelectRow" @click="showMenu=2030 + (index+1)">
        <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="cngAusw(symbol); showMenu=203">{{ symbol }}</button>
      </div>
        <!-- BeinSchmerz -->
      <div v-for="(rows, index) in Schmerz[3]" v-if="(showMenu==204)||((showMenu>2040)&&(showMenu<2050))" :id="'Schmerz' + index" class="SelectRow" @click="showMenu=2040 + (index+1)">
        <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="cngAusw(symbol); showMenu=204">{{ symbol }}</button>
      </div>

      <div id="Skala" v-if="((200<showMenu)&&(showMenu<300))||((2000<showMenu)&&(showMenu<3000))" class="SelectRow" style="width: 99%"  @click="showMenu=20001">
        <button @click="showMenu=20001" class="SelectButton">Zur Schmerzskala</button>
      </div>

    <!-- Schmerzskala-Untermen√º -->
      <hr v-if="showMenu==20001" style="color:var(--maincolor);margin-left:0;width:80%;margin:auto;margin-top:2%;margin-bottom:3%">
      <div v-if="showMenu==20001" class="keydesign">
      <button v-for="symbol in Schmerzskala" :id="symbol" class="SelectButton" @click="cngGrad(symbol);">{{ symbol }}</button>
      </div>
      <div v-if="showMenu==20001" >
        <p style="text-align:left" class="site_name">
          Stark
          <span style="float:right;">
            Leicht
          </span>
        </p>
      </div>

    <!-- Nachrichten Men√º -->
      
      <div v-for="(rows, index) in Keyboards[selectedKeyboard]" v-if="(showMenu==3)||((showMenu>300)&&(showMenu<400))" :id="'row' + index" class="keydesign" @click="showMenu=300 + (index+1); blancDiv('row'+index,300+(index+1))">
        <button v-for="symbol in rows" :id="symbol" class ="KeyboardButton" @click="addChar(symbol)">{{ symbol }}</button>
      </div>

      <!-- Letzte 3 Zeilen der Tastatur alpha & fast -->
      <div v-if="selectedKeyboard!=1">
        <div id="row5" v-if="(showMenu==3)||((showMenu>300)&&(showMenu<400))" class="keydesign" style="width: 99%" @click="addChar(' ')">
          <button class ="KeyboardButton" style="background-color: #e7e7e7;">Leerzeichen</button>
        </div>
        <div id="row6" v-if="(showMenu==3)||((showMenu>300)&&(showMenu<400))" class="keydesign" style="width: 99%" @click="showMenu=307">
          <button id="L√∂schen" class ="KeyboardButton" @click="delChar()" style="background-color: #e7e7e7;">L√∂schen</button>
          <button id="AllesLoschen" class ="KeyboardButton" @click="delallChar()" style="background-color: #e7e7e7;">Alles L√∂schen</button>
        </div>
        <div id="row7" v-if="(showMenu==3)||((showMenu>300)&&(showMenu<400))" class="keydesign" style="width: 99%">
          <button id="Zahlen" class ="KeyboardButton" @click="showMenu=3071" style="background-color: #e7e7e7;">Zahlen</button>
          <button id="zuUmgebung" class ="KeyboardButton" @click="showMenu=4" style="background-color: #e7e7e7;">Umgebung</button>
          <button id="zuIch" class ="KeyboardButton" @click="showMenu=5" style="background-color: #e7e7e7;">Ich</button>
        </div>
      </div>

      <!-- Letzte 3 Zeilen der Tastatur QWERTZ -->
      <div v-if="selectedKeyboard==1">
        <div id="row4" v-if="(showMenu==3)||((showMenu>300)&&(showMenu<400))" class="keydesign" style="width: 99%" @click="addChar(' ')">
          <button class ="KeyboardButton" style="background-color: #e7e7e7;">Leerzeichen</button>
        </div>
        <div id="row5" v-if="(showMenu==3)||((showMenu>300)&&(showMenu<400))" class="keydesign" style="width: 99%" @click="showMenu=306">
          <button id="L√∂schen" class ="KeyboardButton" @click="delChar()" style="background-color: #e7e7e7;">L√∂schen</button>
          <button id="AllesLoschen" class ="KeyboardButton" @click="delallChar()" style="background-color: #e7e7e7;">Alles L√∂schen</button>
        </div>
        <div id="row6" v-if="(showMenu==3)||((showMenu>300)&&(showMenu<400))" class="keydesign" style="width: 99%">
          <button id="zuUmgebung" class ="KeyboardButton" @click="showMenu=4" style="background-color: #e7e7e7;">Umgebung</button>
          <button id="zuIch" class ="KeyboardButton" @click="showMenu=5" style="background-color: #e7e7e7;">Ich</button>
        </div>
      </div>

    <!-- Zahlen-Men√º in Nachricht-Men√º -->

        <div v-for="(rows, index) in ZahlenMenu" v-if="(showMenu==(3071))||((showMenu>30710)&&(showMenu<30720))" :id="'numpad' + index" class="keydesign" @click="showMenu=30710 + (index+1)">
        <button v-for="symbol in rows" :id="symbol" class ="KeyboardButton" @click="addChar(symbol); showMenu=3071">{{ symbol }}</button>
      </div>
      
    <!-- Umgebung-Schnelbaustein Men√º -->
      <div v-if="showMenu==4" class="buttonstyles">
        <button id="Gespr√§ch" @click="showMenu=401">Gespr√§ch</button>
        <button id="Gegenst√§nde" @click="showMenu=402">Gegenst√§nde</button>
        <button id="ImZimmer" @click="showMenu=403">Im Zimmer</button>
        <button id="ImBett" @click="showMenu=404">Im Bett</button>
      </div>
      <!-- Gespr√§ch-Untermen√º -->
        <div v-for="(rows, index) in UmgebungMenu[0]" v-if="(showMenu==401)||((showMenu>4010)&&(showMenu<4020))" :id="'Umwelt' + index" class="SelectRow" @click="showMenu=4010 + (index+1)">
          <button v-for="symbol in rows" :id="symbol" class="SelectButton" style="font-size: 3vh" @click="addChar(symbol); showMenu=401">{{ symbol }}</button>
        </div>

      <!-- Gegenst√§nde-Untermen√º -->    
        <div v-for="(rows, index) in UmgebungMenu[1]" v-if="(showMenu==402)||((showMenu>4020)&&(showMenu<4030))" :id="'Umwelt' + index" class="SelectRow" @click="showMenu=4020 + (index+1)">
          <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="addChar(symbol); showMenu=402">{{ symbol }}</button>
        </div>

      <!-- Im Zimmer-Untermen√º -->
        <div v-for="(rows, index) in UmgebungMenu[2]" v-if="(showMenu==403)||((showMenu>4030)&&(showMenu<4040))" :id="'Umwelt' + index" class="SelectRow" @click="showMenu=4030 + (index+1)">
          <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="addChar(symbol);showMenu=403">{{ symbol }}</button>
        </div>
      <!-- Im Bett-Untermen√º -->
        <div v-for="(rows, index) in UmgebungMenu[3]" v-if="(showMenu==404)||((showMenu>4040)&&(showMenu<4050))" :id="'Umwelt' + index" class="SelectRow" @click="showMenu=4040 + (index+1)">
          <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="addChar(symbol);showMenu=404">{{ symbol }}</button>
        </div>

    <!-- Ich-Schnellbaustein Men√º -->

      <div v-if="showMenu==5" class="buttonstyles">
        <button id="Ern√§hrung" @click="showMenu=501">Ern√§hrung</button>
        <button id="Gef√ºhle" @click="showMenu=502">Gef√ºhle</button>
        <button id="Kleidung" @click="showMenu=503">Kleidung</button>
        <button id="Hygiene" @click="showMenu=504">Hygiene</button>
        <button id="Bewegung" @click="showMenu=505">Bewegung</button>
      </div>

      <!-- Ern√§hrung-Untermen√º -->
        <div v-for="(rows, index) in IchMenu[0]" v-if="(showMenu==501)||((showMenu>5010)&&(showMenu<5020))" :id="'Ich' + index" class="SelectRow" @click="showMenu=5010 + (index+1)">
          <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="addChar(symbol); showMenu=501">{{ symbol }}</button>
        </div>
      <!-- Gef√ºhle-Untermen√º -->
        <div v-for="(rows, index) in IchMenu[1]" v-if="(showMenu==502)||((showMenu>5020)&&(showMenu<5030))" :id="'Ich' + index" class="SelectRow" @click="showMenu=5020 + (index+1)">
          <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="addChar(symbol); showMenu=502">{{ symbol }}</button>
        </div>
      <!-- Kleidung-Untermen√º -->
        <div v-for="(rows, index) in IchMenu[2]" v-if="(showMenu==503)||((showMenu>5030)&&(showMenu<5040))" :id="'Ich' + index" class="SelectRow" @click="showMenu=5030 + (index+1)">
          <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="addChar(symbol); showMenu=503">{{ symbol }}</button>
        </div>
      <!-- Hygiene-Untermen√º -->
        <div v-for="(rows, index) in IchMenu[3]" v-if="(showMenu==504)||((showMenu>5040)&&(showMenu<5050))" :id="'Ich' + index" class="SelectRow" @click="showMenu=5040 + (index+1)">
          <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="addChar(symbol); showMenu=504">{{ symbol }}</button>
        </div>
      <!-- Bewegung-Untermen√º -->
        <div v-for="(rows, index) in IchMenu[4]" v-if="(showMenu==505)||((showMenu>5050)&&(showMenu<5060))" :id="'Ich' + index" class="SelectRow" @click="showMenu=5050 + (index+1)">
          <button v-for="symbol in rows" :id="symbol" class="SelectButton" @click="addChar(symbol); showMenu=505">{{ symbol }}</button>
        </div>

    <!-- Zur√ºck zu Nachricht-Men√º in den Schnellmen√ºs -->
     <div id="GoToNachricht" v-if="((showMenu>400)&&(showMenu<600))||((showMenu>4000)&&(showMenu<6000))" class="SelectRow" @click="showMenu=3">
      <button class="SelectButton">Zum Nachrichten-Men√º</button>
     </div>

    <!-- Einstellungs-Men√º -->
    <div  v-if="(showMenu==6)||((600<showMenu)&&(showMenu<700))" >
      <div class="buttonstyles" style="width:85%">
        <button id="Tastaturdesign" @click="showMenu=601; blancButton('Tastaturdesign',601)">Tastatur- Design</button>
        <button id="Leuchtgeschwindigkeit" @click="showMenu=602; blancButton('Leuchtgeschwindigkeit',602)">Leucht- Dauer</button>
        <button id="Blinzeldauer" @click="showMenu=603; blancButton('Blinzeldauer',603)">Blinzeldauer</button>
        <button id="Farbmodus" @click="dayNight(); blancButton('Farbmodus',604)">Farbmodus</button>
      </div>
      <hr style="color:var(--maincolor);margin-left:0;width:80%;margin:auto;margin-top:10px">

      <div v-if="showMenu==601" class="keydesign">
        <button id="Alphabetisch" class="SelectButton" @click="selectedKeyboard=0; showMenu=6; cngHinweis('Tastaturdesign ')">Alphabetisch</button>
        <button id="Quertz" class="SelectButton" @click="selectedKeyboard=1; showMenu=6; cngHinweis('Tastaturdesign ')">Quertz</button>
        <button id="H√§ufigkeit" class="SelectButton" @click="selectedKeyboard=2; showMenu=6; cngHinweis('Tastaturdesign ')">H√§ufigkeit</button>
      </div>

      <div v-if="showMenu==602" class="keydesign">
        <button v-for="symbol in Blinkzeiten" :id=" 'speed' + symbol" class="SelectButton" style="font-size: 1.5em"  @click="cngLeuchtgsw(symbol); showMenu=6; cngHinweis('Leuchtgeschwindigkeit ')">{{ symbol }} Sekunde/n</button>
      </div>

      <div v-if="showMenu==603" class="Keydesign" >
        <p class="site_name" style="font-size: 1.5em" >Bitte blinzeln Sie so lange, bis eine Aktion von Ihnen registriert werden soll.</p>
        <div class="keydesign">
          <button id="BerechnenBlinzeln" class="SelectButton" @click="cngTime_closed=true; cngHinweis('Blinzeldauer '); showMenu=6">Bitte Blinzeln</button>
        </div>
      </div>
        
    </div>

    <!-- Hinweise f√ºr Nachrichten-Men√º -->  
      <div v-if="(showMenu==6)||((600<showMenu)&&(showMenu<700))" class="site_name" style="width:80%; display:inline-block; text-align:center;">
        <i id="Hinweis"></i>
      </div>
  <!-- Programier-Hilfe -->
    <div v-if="dbug">
      <hr style="color:var(--maincolor);margin-left:0;width:80%;margin:auto;margin-top:10px">
      <p>Programier-Hilfe:</p>
      <p>Aktuelles Men√º:{{ this.showMenu }}</p>
    </div>
    </div>
  <!-- hiervon kommt der Video-Input. Nicht auskommentieren! -->
  <video id="input_video" facingMode='user' style="margin:auto;"></video>
</body>
</html>